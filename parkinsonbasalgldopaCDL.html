<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Basal Ganglia Pathway Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header .simulation-badge {
            font-size: 1em;
            font-weight: 600;
            opacity: 0.95;
            margin-top: 5px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 30px;
            background: #f8f9fa;
            flex-wrap: wrap;
        }

        .control-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .control-group label {
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .btn {
            padding: 15px 30px;
            font-size: 1em;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-normal {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-parkinson {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-huntington {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-parkinson-treated {
            background: linear-gradient(135deg, #a8e063 0%, #56ab2f 100%);
            color: white;
        }

        .btn-huntington-treated {
            background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%);
            color: white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.2);
        }

        .btn.active {
            box-shadow: 0 0 20px rgba(0,0,0,0.4);
            transform: scale(1.05);
        }

        .pathway-selector {
            display: flex;
            gap: 15px;
        }

        .pathway-btn {
            padding: 10px 20px;
            background: white;
            border: 2px solid #667eea;
            color: #667eea;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .pathway-btn:hover {
            background: #667eea;
            color: white;
        }

        .pathway-btn.active {
            background: #667eea;
            color: white;
        }

        .main-content {
            display: flex;
            gap: 20px;
            padding: 30px;
        }

        .canvas-container {
            flex: 1;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            position: relative;
        }

        canvas {
            width: 100%;
            height: 600px;
            border-radius: 10px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .info-panel {
            width: 350px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            overflow-y: auto;
            max-height: 640px;
        }

        .info-section {
            margin-bottom: 25px;
        }

        .info-section h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 8px;
        }

        .info-section p, .info-section ul {
            color: #555;
            line-height: 1.8;
            margin-bottom: 10px;
        }

        .info-section ul {
            padding-left: 20px;
        }

        .neurotransmitter {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: 600;
            font-size: 0.9em;
            margin: 2px;
        }

        .nt-glutamate {
            background: #ff6b6b;
            color: white;
        }

        .nt-gaba {
            background: #4ecdc4;
            color: white;
        }

        .nt-dopamine {
            background: #ffe66d;
            color: #333;
        }

        .medication {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 5px;
            font-weight: 600;
            font-size: 0.9em;
            margin: 2px;
            background: #a8e063;
            color: white;
        }

        .disease-state {
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-weight: 600;
        }

        .state-normal {
            background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
            color: #2c3e50;
        }

        .state-parkinson {
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            color: #c0392b;
        }

        .state-huntington {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            color: #2980b9;
        }

        .state-treated {
            background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
            color: #27ae60;
        }

        .animation-info {
            margin-top: 20px;
            padding: 15px;
            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
            border-radius: 10px;
            font-size: 0.95em;
            color: #2c3e50;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ðŸ§  Basal Ganglia Pathway Simulator</h1>
            <p>Interactive visualization of neurotransmitter pathways and disease states</p>
            <div class="simulation-badge">Hafeez Faridi Ph.D.</div>
        </div>

        <div class="controls">
            <div class="control-group">
                <label>Select State:</label>
                <div style="display: flex; gap: 15px; flex-wrap: wrap; justify-content: center;">
                    <button class="btn btn-normal active" onclick="setState('normal')">Normal</button>
                    <button class="btn btn-parkinson" onclick="setState('parkinson')">Parkinson's</button>
                    <button class="btn btn-parkinson-treated" onclick="setState('parkinson-treated')">PD + L-Dopa</button>
                    <button class="btn btn-huntington" onclick="setState('huntington')">Huntington's</button>
                    <button class="btn btn-huntington-treated" onclick="setState('huntington-treated')">HD + VMAT2i</button>
                </div>
            </div>

            <div class="control-group">
                <label>Highlight Pathway:</label>
                <div class="pathway-selector">
                    <button class="pathway-btn" onclick="highlightPathway('direct')">Direct</button>
                    <button class="pathway-btn" onclick="highlightPathway('indirect')">Indirect</button>
                    <button class="pathway-btn active" onclick="highlightPathway('both')">Both</button>
                </div>
            </div>
        </div>

        <div class="main-content">
            <div class="canvas-container">
                <canvas id="pathwayCanvas"></canvas>
            </div>

            <div class="info-panel" id="infoPanel">
                <!-- Dynamic content will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('pathwayCanvas');
        const ctx = canvas.getContext('2d');
        
        let currentState = 'normal';
        let highlightedPathway = 'both';
        let animationFrame = 0;

        function resizeCanvas() {
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * 2;
            canvas.height = rect.height * 2;
            ctx.scale(2, 2);
        }
        resizeCanvas();

        const structures = {
            cortex: { x: 300, y: 50, width: 120, height: 40, label: 'Motor Cortex' },
            striatum: { x: 300, y: 150, width: 120, height: 60, label: 'Striatum\n(Caudate/Putamen)' },
            gpe: { x: 150, y: 270, width: 100, height: 50, label: 'GPe' },
            gpi: { x: 450, y: 270, width: 100, height: 50, label: 'GPi/SNr' },
            stn: { x: 150, y: 380, width: 100, height: 40, label: 'STN' },
            thalamus: { x: 300, y: 480, width: 120, height: 50, label: 'Thalamus' },
            snc: { x: 550, y: 150, width: 80, height: 40, label: 'SNc' }
        };

        function drawRoundedRect(x, y, w, h, r, color, label) {
            ctx.fillStyle = color;
            ctx.beginPath();
            ctx.moveTo(x + r, y);
            ctx.lineTo(x + w - r, y);
            ctx.quadraticCurveTo(x + w, y, x + w, y + r);
            ctx.lineTo(x + w, y + h - r);
            ctx.quadraticCurveTo(x + w, y + h, x + w - r, y + h);
            ctx.lineTo(x + r, y + h);
            ctx.quadraticCurveTo(x, y + h, x, y + h - r);
            ctx.lineTo(x, y + r);
            ctx.quadraticCurveTo(x, y, x + r, y);
            ctx.closePath();
            ctx.fill();
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 3;
            ctx.stroke();

            ctx.fillStyle = 'white';
            ctx.font = 'bold 14px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            const lines = label.split('\n');
            lines.forEach((line, i) => {
                ctx.fillText(line, x + w/2, y + h/2 + (i - (lines.length-1)/2) * 16);
            });
        }

        function drawArrow(x1, y1, x2, y2, color, nt, thickness, animated) {
            ctx.strokeStyle = color;
            ctx.lineWidth = thickness;
            
            if (animated) {
                ctx.setLineDash([10, 10]);
                ctx.lineDashOffset = -animationFrame;
            } else {
                ctx.setLineDash([]);
            }

            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();

            const angle = Math.atan2(y2 - y1, x2 - x1);
            const headlen = 15;
            ctx.beginPath();
            ctx.moveTo(x2, y2);
            ctx.lineTo(x2 - headlen * Math.cos(angle - Math.PI / 6), y2 - headlen * Math.sin(angle - Math.PI / 6));
            ctx.lineTo(x2 - headlen * Math.cos(angle + Math.PI / 6), y2 - headlen * Math.sin(angle + Math.PI / 6));
            ctx.closePath();
            ctx.fillStyle = color;
            ctx.fill();

            ctx.setLineDash([]);

            ctx.fillStyle = 'white';
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 3;
            ctx.font = 'bold 11px Arial';
            ctx.textAlign = 'center';
            const midX = (x1 + x2) / 2;
            const midY = (y1 + y2) / 2;
            ctx.strokeText(nt, midX, midY - 5);
            ctx.fillText(nt, midX, midY - 5);
        }

        function drawInhibitory(x1, y1, x2, y2, color, nt, thickness, animated) {
            ctx.strokeStyle = color;
            ctx.lineWidth = thickness;
            
            if (animated) {
                ctx.setLineDash([10, 10]);
                ctx.lineDashOffset = -animationFrame;
            } else {
                ctx.setLineDash([]);
            }

            ctx.beginPath();
            ctx.moveTo(x1, y1);
            ctx.lineTo(x2, y2);
            ctx.stroke();

            ctx.beginPath();
            ctx.arc(x2, y2, 8, 0, Math.PI * 2);
            ctx.fillStyle = color;
            ctx.fill();
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 2;
            ctx.stroke();

            ctx.setLineDash([]);

            ctx.fillStyle = 'white';
            ctx.strokeStyle = '#2c3e50';
            ctx.lineWidth = 3;
            ctx.font = 'bold 11px Arial';
            ctx.textAlign = 'center';
            const midX = (x1 + x2) / 2;
            const midY = (y1 + y2) / 2;
            ctx.strokeText(nt, midX, midY - 5);
            ctx.fillText(nt, midX, midY - 5);
        }

        function drawPathways() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const isDirectActive = highlightedPathway === 'direct' || highlightedPathway === 'both';
            const isIndirectActive = highlightedPathway === 'indirect' || highlightedPathway === 'both';

            let dopamineLevel = 1.0;
            let directPathwayStrength = 1.0;
            let indirectPathwayStrength = 1.0;
            let gpiActivity = 0.7;
            let thalamusActivity = 1.0;

            // Parkinson's disease - untreated
            if (currentState === 'parkinson') {
                dopamineLevel = 0.2;
                directPathwayStrength = 0.3;
                indirectPathwayStrength = 1.5;
                gpiActivity = 1.8;
                thalamusActivity = 0.4;
            }
            // Parkinson's treated with L-Dopa
            else if (currentState === 'parkinson-treated') {
                dopamineLevel = 0.75;
                directPathwayStrength = 0.8;
                indirectPathwayStrength = 1.0;
                gpiActivity = 0.9;
                thalamusActivity = 0.85;
            }
            // Huntington's disease - untreated
            else if (currentState === 'huntington') {
                dopamineLevel = 1.0;
                directPathwayStrength = 1.0;
                indirectPathwayStrength = 0.3;
                gpiActivity = 0.3;
                thalamusActivity = 1.8;
            }
            // Huntington's treated with VMAT2 inhibitor
            else if (currentState === 'huntington-treated') {
                dopamineLevel = 0.6;
                directPathwayStrength = 0.8;
                indirectPathwayStrength = 0.5;
                gpiActivity = 0.6;
                thalamusActivity = 1.2;
            }

            // DIRECT PATHWAY
            if (isDirectActive) {
                drawArrow(360, 90, 360, 145, '#ff6b6b', 'Glu', 4, true);
                
                let directColor = `rgba(76, 205, 196, ${directPathwayStrength})`;
                let directThickness = 3 + directPathwayStrength * 3;
                drawInhibitory(420, 180, 490, 265, directColor, 'GABA', directThickness, currentState !== 'normal');
                
                let gpiColor = `rgba(76, 205, 196, ${gpiActivity})`;
                let gpiThickness = 3 + gpiActivity * 4;
                drawInhibitory(480, 320, 390, 475, gpiColor, 'GABA', gpiThickness, currentState !== 'normal');
            }

            // INDIRECT PATHWAY
            if (isIndirectActive) {
                if (!isDirectActive) {
                    drawArrow(360, 90, 360, 145, '#ff6b6b', 'Glu', 4, true);
                }
                
                let indirectColor = `rgba(76, 205, 196, ${indirectPathwayStrength})`;
                let indirectThickness = 3 + indirectPathwayStrength * 3;
                drawInhibitory(280, 180, 210, 265, indirectColor, 'GABA', indirectThickness, currentState !== 'normal');
                
                let gpeStrength = 1.0 / Math.max(indirectPathwayStrength, 0.5);
                let gpeColor = `rgba(76, 205, 196, ${gpeStrength})`;
                let gpeThickness = 3 + gpeStrength * 3;
                drawInhibitory(190, 320, 190, 375, gpeColor, 'GABA', gpeThickness, currentState !== 'normal');
                
                let stnStrength = 1.0 / gpeStrength;
                let stnColor = `rgba(255, 107, 107, ${stnStrength})`;
                let stnThickness = 3 + stnStrength * 4;
                drawArrow(250, 400, 450, 290, stnColor, 'Glu', stnThickness, currentState !== 'normal');
            }

            // Thalamus -> Cortex
            let thalamusColor = `rgba(255, 107, 107, ${thalamusActivity})`;
            let thalamusThickness = 3 + thalamusActivity * 5;
            drawArrow(280, 490, 280, 95, thalamusColor, 'Glu', thalamusThickness, currentState !== 'normal');

            // SNc -> Striatum (Dopamine)
            let dopamineColor = `rgba(255, 230, 109, ${dopamineLevel})`;
            let dopamineThickness = 3 + dopamineLevel * 4;
            drawArrow(550, 175, 420, 165, dopamineColor, 'DA', dopamineThickness, 
                     currentState === 'parkinson' || currentState === 'huntington-treated');

            // Draw structures
            drawRoundedRect(structures.cortex.x, structures.cortex.y, structures.cortex.width, structures.cortex.height, 10, '#3498db', structures.cortex.label);
            
            let striatumColor = '#2ecc71';
            if (currentState === 'huntington' || currentState === 'huntington-treated') striatumColor = '#e74c3c';
            drawRoundedRect(structures.striatum.x, structures.striatum.y, structures.striatum.width, structures.striatum.height, 10, striatumColor, structures.striatum.label);
            
            drawRoundedRect(structures.gpe.x, structures.gpe.y, structures.gpe.width, structures.gpe.height, 10, '#9b59b6', structures.gpe.label);
            drawRoundedRect(structures.gpi.x, structures.gpi.y, structures.gpi.width, structures.gpi.height, 10, '#e67e22', structures.gpi.label);
            drawRoundedRect(structures.stn.x, structures.stn.y, structures.stn.width, structures.stn.height, 10, '#f39c12', structures.stn.label);
            drawRoundedRect(structures.thalamus.x, structures.thalamus.y, structures.thalamus.width, structures.thalamus.height, 10, '#1abc9c', structures.thalamus.label);
            
            let sncColor = currentState === 'parkinson' || currentState === 'parkinson-treated' ? '#e74c3c' : '#34495e';
            drawRoundedRect(structures.snc.x, structures.snc.y, structures.snc.width, structures.snc.height, 10, sncColor, structures.snc.label);
        }

        function updateInfoPanel() {
            const panel = document.getElementById('infoPanel');
            let content = '';

            if (currentState === 'normal') {
                content = `
                    <div class="disease-state state-normal">
                        <strong>NORMAL PHYSIOLOGY</strong>
                    </div>
                    
                    <div class="info-section">
                        <h3>Direct Pathway (Go)</h3>
                        <p>Facilitates desired movements through <strong>disinhibition</strong>:</p>
                        <ul>
                            <li><span class="neurotransmitter nt-glutamate">Glutamate</span> from cortex excites striatum</li>
                            <li><span class="neurotransmitter nt-gaba">GABA</span> from striatum inhibits GPi/SNr</li>
                            <li>Reduced GPi/SNr activity = less inhibition of thalamus</li>
                            <li>Thalamus excites motor cortex â†’ <strong>Movement occurs</strong></li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Indirect Pathway (No-Go)</h3>
                        <p>Suppresses competing movements:</p>
                        <ul>
                            <li><span class="neurotransmitter nt-gaba">GABA</span> from striatum inhibits GPe</li>
                            <li>Reduced GPe = less inhibition of STN</li>
                            <li><span class="neurotransmitter nt-glutamate">Glutamate</span> from STN excites GPi/SNr</li>
                            <li>Increased GPi/SNr inhibits thalamus â†’ <strong>Unwanted movements suppressed</strong></li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Dopamine Modulation</h3>
                        <p><span class="neurotransmitter nt-dopamine">Dopamine</span> from SNc fine-tunes both pathways:</p>
                        <ul>
                            <li><strong>D1 receptors:</strong> Enhance direct pathway</li>
                            <li><strong>D2 receptors:</strong> Inhibit indirect pathway</li>
                            <li>Result: Smooth, coordinated movement</li>
                        </ul>
                    </div>
                `;
            } else if (currentState === 'parkinson') {
                content = `
                    <div class="disease-state state-parkinson">
                        <strong>PARKINSON'S DISEASE (Untreated)</strong>
                    </div>

                    <div class="info-section">
                        <h3>Pathophysiology</h3>
                        <p><strong>Loss of dopaminergic neurons</strong> in SNc (50-80% by symptom onset)</p>
                        <p><span class="neurotransmitter nt-dopamine">Dopamine</span> depletion in striatum</p>
                    </div>

                    <div class="info-section">
                        <h3>Circuit Imbalance</h3>
                        <p><strong>Direct Pathway UNDERACTIVE:</strong></p>
                        <ul>
                            <li>â†“ D1 activation â†’ â†“ striatal inhibition of GPi</li>
                            <li>GPi remains hyperactive</li>
                        </ul>
                        <p><strong>Indirect Pathway OVERACTIVE:</strong></p>
                        <ul>
                            <li>â†“ D2 inhibition â†’ â†‘ striatal output</li>
                            <li>â†‘ GPe inhibition â†’ â†“ GPe activity</li>
                            <li>â†“ STN inhibition â†’ â†‘ STN excitation of GPi</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Clinical Features</h3>
                        <p><strong>Excessive GPi activity â†’ Thalamus over-inhibited</strong></p>
                        <ul>
                            <li><strong>Bradykinesia:</strong> Slowness of movement</li>
                            <li><strong>Rigidity:</strong> Increased muscle tone</li>
                            <li><strong>Tremor at rest:</strong> 4-6 Hz tremor</li>
                            <li><strong>Postural instability:</strong> Balance problems</li>
                        </ul>
                    </div>

                    <div class="animation-info">
                        <strong>Visualization:</strong> Faded pathways = reduced activity; thick pathways = excessive activity; red SNc = neurodegeneration
                    </div>
                `;
            } else if (currentState === 'parkinson-treated') {
                content = `
                    <div class="disease-state state-treated">
                        <strong>PARKINSON'S DISEASE + L-DOPA TREATMENT</strong>
                    </div>

                    <div class="info-section">
                        <h3>Medication: Levodopa (L-Dopa)</h3>
                        <p><span class="medication">Levodopa/Carbidopa</span> (Sinemet, Rytary)</p>
                        <p><strong>Mechanism of Action:</strong></p>
                        <ul>
                            <li>Levodopa = dopamine precursor</li>
                            <li>Crosses blood-brain barrier</li>
                            <li>Converted to <span class="neurotransmitter nt-dopamine">dopamine</span> in brain</li>
                            <li>Carbidopa prevents peripheral breakdown</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Therapeutic Effects</h3>
                        <p><strong>Restores dopamine signaling:</strong></p>
                        <ul>
                            <li>â†‘ D1 activation â†’ enhances direct pathway</li>
                            <li>â†‘ D2 activation â†’ reduces indirect pathway</li>
                            <li>GPi activity normalizes (partially)</li>
                            <li>Thalamic disinhibition improves</li>
                        </ul>
                        <p><strong>Clinical Improvement:</strong></p>
                        <ul>
                            <li>Reduced bradykinesia and rigidity</li>
                            <li>Improved motor function</li>
                            <li>Most effective for bradykinetic symptoms</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Long-term Complications</h3>
                        <ul>
                            <li><strong>Wearing-off:</strong> Symptoms return before next dose</li>
                            <li><strong>Dyskinesias:</strong> Involuntary movements at peak dose</li>
                            <li><strong>On-off fluctuations:</strong> Unpredictable motor changes</li>
                            <li>Due to progressive neuron loss and pulsatile dopamine delivery</li>
                        </ul>
                    </div>

                    <div class="animation-info">
                        <strong>Visualization:</strong> Improved dopamine levels (brighter yellow), more balanced pathway activity, partially restored thalamic output
                    </div>
                `;
            } else if (currentState === 'huntington') {
                content = `
                    <div class="disease-state state-huntington">
                        <strong>HUNTINGTON'S DISEASE (Untreated)</strong>
                    </div>

                    <div class="info-section">
                        <h3>Pathophysiology</h3>
                        <p><strong>CAG repeat expansion</strong> â†’ mutant huntingtin protein</p>
                        <p><strong>Loss of GABAergic medium spiny neurons</strong> in striatum</p>
                        <p style="color: #e74c3c; font-weight: 600;">Red striatum = neurodegeneration</p>
                    </div>

                    <div class="info-section">
                        <h3>Circuit Changes (Early Stage)</h3>
                        <p><strong>Indirect pathway preferentially affected:</strong></p>
                        <ul>
                            <li>â†“ Striatal inhibition of GPe</li>
                            <li>â†‘ GPe inhibition of STN</li>
                            <li>â†“ STN excitation of GPi</li>
                            <li>â†“ GPi activity â†’ less thalamic inhibition</li>
                            <li>â†‘ Thalamic excitation of cortex</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Clinical Features</h3>
                        <p><strong>Early: Chorea (hyperkinesia)</strong></p>
                        <ul>
                            <li>Involuntary, dance-like movements</li>
                            <li>Excessive thalamo-cortical activity</li>
                            <li>Loss of movement suppression</li>
                        </ul>
                        <p><strong>Late: Bradykinesia & rigidity</strong></p>
                        <ul>
                            <li>Direct pathway also degenerates</li>
                            <li>Progressive cognitive decline</li>
                            <li>Psychiatric symptoms</li>
                        </ul>
                    </div>
                `;
            } else if (currentState === 'huntington-treated') {
                content = `
                    <div class="disease-state state-treated">
                        <strong>HUNTINGTON'S DISEASE + VMAT2 INHIBITOR</strong>
                    </div>

                    <div class="info-section">
                        <h3>Medications: VMAT2 Inhibitors</h3>
                        <p><span class="medication">Tetrabenazine</span> (Xenazine)</p>
                        <p><span class="medication">Deutetrabenazine</span> (Austedo)</p>
                        <p><span class="medication">Valbenazine</span> (Ingrezza)</p>
                        <p><strong>Mechanism of Action:</strong></p>
                        <ul>
                            <li>Inhibit VMAT2 (vesicular monoamine transporter 2)</li>
                            <li>Block <span class="neurotransmitter nt-dopamine">dopamine</span> packaging into vesicles</li>
                            <li>Reduce dopamine release in striatum</li>
                            <li>Dampens excessive thalamo-cortical activity</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Therapeutic Effects</h3>
                        <p><strong>Reduces chorea through dopamine depletion:</strong></p>
                        <ul>
                            <li>â†“ Dopamine â†’ moderates both pathways</li>
                            <li>â†“ Direct pathway activity (D1)</li>
                            <li>â†‘ Indirect pathway tone (less D2 inhibition)</li>
                            <li>â†‘ GPi activity â†’ more thalamic inhibition</li>
                            <li>â†“ Excessive cortical excitation</li>
                        </ul>
                        <p><strong>Clinical Improvement:</strong></p>
                        <ul>
                            <li>30-50% reduction in chorea severity</li>
                            <li>Improved functional capacity</li>
                            <li>Better quality of life</li>
                        </ul>
                    </div>

                    <div class="info-section">
                        <h3>Side Effects & Monitoring</h3>
                        <ul>
                            <li><strong>Parkinsonism:</strong> Can cause PD-like symptoms if dose too high</li>
                            <li><strong>Depression/suicidality:</strong> Screen before treatment</li>
                            <li><strong>Sedation:</strong> Dose-dependent</li>
                            <li><strong>Akathisia:</strong> Restlessness</li>
                            <li>Deutetrabenazine has longer half-life, better tolerability</li>
                        </ul>
                    </div>

                    <div class="animation-info">
                        <strong>Visualization:</strong> Reduced dopamine (faded yellow), increased GPi activity, normalized thalamic output reducing chorea
                    </div>
                `;
            }

            panel.innerHTML = content;
        }

        function setState(state) {
            currentState = state;
            
            document.querySelectorAll('.btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawPathways();
            updateInfoPanel();
        }

        function highlightPathway(pathway) {
            highlightedPathway = pathway;
            
            document.querySelectorAll('.pathway-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            drawPathways();
        }

        function animate() {
            animationFrame = (animationFrame + 1) % 100;
            drawPathways();
            requestAnimationFrame(animate);
        }

        setState('normal');
        animate();

        window.addEventListener('resize', () => {
            resizeCanvas();
            drawPathways();
        });
    </script>
</body>
</html>
